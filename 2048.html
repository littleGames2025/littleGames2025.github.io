<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¶…å¤§ç‰ˆ2048 | ç§»åŠ¨ä¼˜åŒ–</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 10px;
            overflow: hidden;
        }

        .game-container {
            width: 95%;
            max-width: 550px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .title {
            font-size: 2.5rem;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            letter-spacing: 1px;
        }

        .scores-container {
            display: flex;
            gap: 12px;
        }

        .score-box {
            background: rgba(0, 0, 0, 0.2);
            padding: 12px 16px;
            border-radius: 12px;
            text-align: center;
            min-width: 100px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .score-title {
            font-size: 1rem;
            margin-bottom: 5px;
            opacity: 0.9;
        }

        .score-value {
            font-size: 2rem;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .game-intro {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .restart-button {
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .restart-button:hover {
            transform: scale(1.05);
            background: #ff5252;
        }

        .game-explanation {
            font-size: 1rem;
            opacity: 0.85;
            max-width: 60%;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .grid-container {
            position: relative;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 15px;
            margin: 0 auto;
            touch-action: none;
            width: 100%;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 15px;
            width: 100%;
            aspect-ratio: 1/1;
        }

        .grid-cell {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.1);
        }

        .tile {
            position: absolute;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            border-radius: 10px;
            transition: all 0.15s ease;
            z-index: 10;
            font-size: 1.8rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .tile-new {
            animation: appear 0.2s;
        }

        .tile-merged {
            animation: pop 0.2s;
        }

        .game-message {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 12px;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            padding: 20px;
            text-align: center;
        }

        .game-message p {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 25px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .game-message button {
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 15px 35px;
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .swipe-instruction {
            text-align: center;
            margin-top: 15px;
            font-size: 1.1rem;
            opacity: 0.85;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        @keyframes appear {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes pop {
            0% { transform: scale(0.8); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* å“åº”å¼è®¾è®¡ - ä¼˜åŒ–æ¸¸æˆåŒºåŸŸå¤§å° */
        @media (max-width: 500px) {
            .game-container {
                padding: 15px;
                width: 100%;
            }
            
            .title {
                font-size: 2.2rem;
            }
            
            .score-box {
                padding: 10px 14px;
                min-width: 90px;
            }
            
            .score-value {
                font-size: 1.8rem;
            }
            
            .restart-button {
                padding: 10px 20px;
                font-size: 1rem;
            }
            
            .grid {
                gap: 12px;
            }
            
            .grid-container {
                padding: 12px;
            }
            
            .grid-cell {
                border-radius: 8px;
            }
        }

        @media (max-width: 400px) {
            .title {
                font-size: 2rem;
            }
            
            .score-box {
                padding: 8px 12px;
                min-width: 80px;
            }
            
            .score-value {
                font-size: 1.6rem;
            }
            
            .game-explanation {
                font-size: 0.9rem;
            }
            
            .grid {
                gap: 10px;
            }
            
            .grid-container {
                padding: 10px;
            }
            
            .tile {
                font-size: 1.6rem;
            }
        }
        
        /* é’ˆå¯¹é«˜åº¦ä¸è¶³çš„è®¾å¤‡ */
        @media (max-height: 700px) {
            .grid {
                gap: 10px;
            }
            
            .game-container {
                padding: 15px 10px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <div class="title">2048</div>
            <div class="scores-container">
                <div class="score-box">
                    <div class="score-title">åˆ†æ•°</div>
                    <div class="score-value" id="score">0</div>
                </div>
                <div class="score-box">
                    <div class="score-title">æœ€ä½³</div>
                    <div class="score-value" id="best-score">0</div>
                </div>
            </div>
        </div>
        
        <div class="game-intro">
            <div class="game-explanation">
                <b>æ¸¸æˆè§„åˆ™ï¼š</b> æ»‘åŠ¨æ–¹å—ï¼Œç›¸åŒæ•°å­—åˆå¹¶ï¼ŒåŠªåŠ›å¾—åˆ°2048æ–¹å—ï¼
            </div>
            <button class="restart-button" id="restart-button">æ–°æ¸¸æˆ</button>
        </div>
        
        <div class="grid-container">
            <div class="grid" id="grid"></div>
            <div class="game-message" id="game-message">
                <p></p>
                <button class="retry-button">å†è¯•ä¸€æ¬¡</button>
            </div>
        </div>
        
        <div class="swipe-instruction">
            åœ¨æ‰‹æœºä¸Šæ»‘åŠ¨å±å¹•æ§åˆ¶æ–¹å—ç§»åŠ¨
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€ç®¡ç†
        const gameState = {
            grid: [],
            score: 0,
            bestScore: 0,
            gameOver: false,
            won: false
        };

        // DOMå…ƒç´ å¼•ç”¨
        const elements = {
            grid: document.getElementById('grid'),
            score: document.getElementById('score'),
            bestScore: document.getElementById('best-score'),
            gameMessage: document.getElementById('game-message'),
            restartButton: document.getElementById('restart-button')
        };

        // æ–¹å—é¢œè‰²é…ç½® - ä½¿ç”¨æ›´é†’ç›®çš„é¢œè‰²æ–¹æ¡ˆ
        const tileColors = {
            2: { background: '#EEE4DA', color: '#786F65' },
            4: { background: '#EDE0C8', color: '#786F65' },
            8: { background: '#F2B179', color: '#F9F6F2' },
            16: { background: '#F59563', color: '#F9F6F2' },
            32: { background: '#F67C5F', color: '#F9F6F2' },
            64: { background: '#F65E3B', color: '#F9F6F2' },
            128: { background: '#EDCF72', color: '#F9F6F2', fontSize: '2.5rem' },
            256: { background: '#EDCC61', color: '#F9F6F2', fontSize: '2.5rem' },
            512: { background: '#EDC850', color: '#F9F6F2', fontSize: '2.5rem' },
            1024: { background: '#EDC53F', color: '#F9F6F2', fontSize: '2rem' },
            2048: { background: '#EDC22E', color: '#F9F6F2', fontSize: '2rem' },
            4096: { background: '#3D3A33', color: '#F9F6F2', fontSize: '1.8rem' },
            8192: { background: '#202020', color: '#F9F6F2', fontSize: '1.8rem' }
        };

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // åˆ›å»ºç½‘æ ¼
            createGrid();
            
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            resetGame();
            
            // æ·»åŠ ä¸¤ä¸ªåˆå§‹æ–¹å—
            addRandomTile();
            addRandomTile();
            
            // æ›´æ–°UI
            updateUI();
            
            // è®¾ç½®äº‹ä»¶ç›‘å¬
            setupEventListeners();
        }

        // åˆ›å»ºç½‘æ ¼ - ç¡®ä¿16ä¸ªç½‘æ ¼å•å…ƒ
        function createGrid() {
            elements.grid.innerHTML = '';
            
            // åˆ›å»º4x4ç½‘æ ¼å•å…ƒ
            for (let i = 0; i < 16; i++) {
                const cell = document.createElement('div');
                cell.className = 'grid-cell';
                elements.grid.appendChild(cell);
            }
            
            // åˆå§‹åŒ–æ¸¸æˆçŠ¶æ€ç½‘æ ¼
            gameState.grid = [
                [0, 0, 0, 0],
                [0, 0, 0, 0],
                [0, 0, 0, 0],
                [0, 0, 0, 0]
            ];
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            gameState.score = 0;
            gameState.gameOver = false;
            gameState.won = false;
            
            // é‡ç½®ç½‘æ ¼
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    gameState.grid[i][j] = 0;
                }
            }
            
            // éšè—æ¸¸æˆæ¶ˆæ¯
            elements.gameMessage.style.display = 'none';
            
            // ç§»é™¤æ‰€æœ‰æ–¹å—
            document.querySelectorAll('.tile').forEach(tile => tile.remove());
        }

        // æ·»åŠ éšæœºæ–¹å—
        function addRandomTile() {
            // æŸ¥æ‰¾ç©ºä½ç½®
            const emptyCells = [];
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    if (gameState.grid[i][j] === 0) {
                        emptyCells.push({ row: i, col: j });
                    }
                }
            }
            
            if (emptyCells.length > 0) {
                // éšæœºé€‰æ‹©ä¸€ä¸ªç©ºä½ç½®
                const randomCell = emptyCells[Math.floor(Math.random() * emptyCells.length)];
                const value = Math.random() < 0.9 ? 2 : 4;
                
                // æ›´æ–°æ¸¸æˆçŠ¶æ€
                gameState.grid[randomCell.row][randomCell.col] = value;
                
                // åˆ›å»ºæ–¹å—å…ƒç´ 
                createTile(randomCell.row, randomCell.col, value, true);
            }
        }

        // åˆ›å»ºæ–¹å— - æ·»åŠ è¡Œ/åˆ—æ•°æ®å±æ€§ç”¨äºå®šä½
        function createTile(row, col, value, isNew = false) {
            const tile = document.createElement('div');
            tile.className = 'tile';
            tile.dataset.row = row;
            tile.dataset.col = col;
            
            if (isNew) tile.classList.add('tile-new');
            
            // è®¾ç½®æ–¹å—æ ·å¼
            tile.textContent = value;
            
            // åº”ç”¨é¢œè‰²å’Œå­—ä½“å¤§å°
            const colorConfig = tileColors[value] || tileColors['8192'];
            tile.style.background = colorConfig.background;
            tile.style.color = colorConfig.color;
            if (colorConfig.fontSize) {
                tile.style.fontSize = colorConfig.fontSize;
            }
            
            // è®¾ç½®ä½ç½®
            updateTilePosition(tile);
            
            // æ·»åŠ åˆ°ç½‘æ ¼å®¹å™¨
            document.querySelector('.grid-container').appendChild(tile);
            
            return tile;
        }

        // æ›´æ–°æ–¹å—ä½ç½® - ç¡®ä¿å‡†ç¡®è®¡ç®—
        function updateTilePosition(tile) {
            const row = parseInt(tile.dataset.row);
            const col = parseInt(tile.dataset.col);
            const grid = document.querySelector('.grid');
            const gridRect = grid.getBoundingClientRect();
            
            // è®¡ç®—å•å…ƒæ ¼å°ºå¯¸
            const cellWidth = gridRect.width / 4;
            const cellHeight = gridRect.height / 4;
            const padding = 5; // è§†è§‰é—´è·
            
            // è®¡ç®—å½“å‰ä½ç½®
            const left = col * cellWidth + padding;
            const top = row * cellHeight + padding;
            
            // è®¾ç½®æ–¹å—å¤§å°ï¼ˆç•¥å°äºå•å…ƒæ ¼ï¼‰
            const size = Math.min(cellWidth, cellHeight) - 2 * padding;
            tile.style.width = `${size}px`;
            tile.style.height = `${size}px`;
            
            // è®¾ç½®ä½ç½®
            tile.style.left = `${left}px`;
            tile.style.top = `${top}px`;
        }

        // ç§»åŠ¨æ–¹å—ï¼ˆå„æ–¹å‘é€»è¾‘ï¼‰
        function move(direction) {
            let moved = false;
            const grid = [...gameState.grid.map(row => [...row])]; // åˆ›å»ºå‰¯æœ¬
            
            switch (direction) {
                case 'up': moved = moveUp(grid); break;
                case 'down': moved = moveDown(grid); break;
                case 'left': moved = moveLeft(grid); break;
                case 'right': moved = moveRight(grid); break;
            }
            
            if (moved) {
                gameState.grid = grid;
                // æ·»åŠ æ–°æ–¹å—
                addRandomTile();
                
                // æ›´æ–°UI
                updateUI();
                
                // æ£€æŸ¥æ¸¸æˆçŠ¶æ€
                checkGameStatus();
            }
        }

        // å‘ä¸Šç§»åŠ¨
        function moveUp(grid) {
            let moved = false;
            for (let col = 0; col < 4; col++) {
                for (let row = 1; row < 4; row++) {
                    if (grid[row][col] !== 0) {
                        let currentRow = row;
                        // å‘ä¸Šç§»åŠ¨ç›´åˆ°é‡åˆ°è¾¹ç•Œæˆ–éç©ºæ ¼å­
                        while (currentRow > 0 && grid[currentRow-1][col] === 0) {
                            grid[currentRow-1][col] = grid[currentRow][col];
                            grid[currentRow][col] = 0;
                            currentRow--;
                            moved = true;
                        }
                        
                        // æ£€æŸ¥æ˜¯å¦å¯ä»¥åˆå¹¶
                        if (currentRow > 0 && grid[currentRow-1][col] === grid[currentRow][col]) {
                            grid[currentRow-1][col] *= 2;
                            gameState.score += grid[currentRow-1][col];
                            grid[currentRow][col] = 0;
                            moved = true;
                        }
                    }
                }
            }
            return moved;
        }

        // å‘ä¸‹ç§»åŠ¨
        function moveDown(grid) {
            let moved = false;
            for (let col = 0; col < 4; col++) {
                for (let row = 2; row >= 0; row--) {
                    if (grid[row][col] !== 0) {
                        let currentRow = row;
                        // å‘ä¸‹ç§»åŠ¨ç›´åˆ°é‡åˆ°è¾¹ç•Œæˆ–éç©ºæ ¼å­
                        while (currentRow < 3 && grid[currentRow+1][col] === 0) {
                            grid[currentRow+1][col] = grid[currentRow][col];
                            grid[currentRow][col] = 0;
                            currentRow++;
                            moved = true;
                        }
                        
                        // æ£€æŸ¥æ˜¯å¦å¯ä»¥åˆå¹¶
                        if (currentRow < 3 && grid[currentRow+1][col] === grid[currentRow][col]) {
                            grid[currentRow+1][col] *= 2;
                            gameState.score += grid[currentRow+1][col];
                            grid[currentRow][col] = 0;
                            moved = true;
                        }
                    }
                }
            }
            return moved;
        }

        // å‘å·¦ç§»åŠ¨
        function moveLeft(grid) {
            let moved = false;
            for (let row = 0; row < 4; row++) {
                for (let col = 1; col < 4; col++) {
                    if (grid[row][col] !== 0) {
                        let currentCol = col;
                        // å‘å·¦ç§»åŠ¨ç›´åˆ°é‡åˆ°è¾¹ç•Œæˆ–éç©ºæ ¼å­
                        while (currentCol > 0 && grid[row][currentCol-1] === 0) {
                            grid[row][currentCol-1] = grid[row][currentCol];
                            grid[row][currentCol] = 0;
                            currentCol--;
                            moved = true;
                        }
                        
                        // æ£€æŸ¥æ˜¯å¦å¯ä»¥åˆå¹¶
                        if (currentCol > 0 && grid[row][currentCol-1] === grid[row][currentCol]) {
                            grid[row][currentCol-1] *= 2;
                            gameState.score += grid[row][currentCol-1];
                            grid[row][currentCol] = 0;
                            moved = true;
                        }
                    }
                }
            }
            return moved;
        }

        // å‘å³ç§»åŠ¨
        function moveRight(grid) {
            let moved = false;
            for (let row = 0; row < 4; row++) {
                for (let col = 2; col >= 0; col--) {
                    if (grid[row][col] !== 0) {
                        let currentCol = col;
                        // å‘å³ç§»åŠ¨ç›´åˆ°é‡åˆ°è¾¹ç•Œæˆ–éç©ºæ ¼å­
                        while (currentCol < 3 && grid[row][currentCol+1] === 0) {
                            grid[row][currentCol+1] = grid[row][currentCol];
                            grid[row][currentCol] = 0;
                            currentCol++;
                            moved = true;
                        }
                        
                        // æ£€æŸ¥æ˜¯å¦å¯ä»¥åˆå¹¶
                        if (currentCol < 3 && grid[row][currentCol+1] === grid[row][currentCol]) {
                            grid[row][currentCol+1] *= 2;
                            gameState.score += grid[row][currentCol+1];
                            grid[row][currentCol] = 0;
                            moved = true;
                        }
                    }
                }
            }
            return moved;
        }

        // æ£€æŸ¥æ¸¸æˆçŠ¶æ€
        function checkGameStatus() {
            // æ£€æŸ¥æ˜¯å¦è·èƒœ
            if (!gameState.won) {
                for (let i = 0; i < 4; i++) {
                    for (let j = 0; j < 4; j++) {
                        if (gameState.grid[i][j] === 2048) {
                            gameState.won = true;
                            showGameMessage("ä½ èµ¢äº†! ğŸ‰", false);
                            return;
                        }
                    }
                }
            }
            
            // æ£€æŸ¥æ˜¯å¦å¤±è´¥
            if (!hasMoves()) {
                gameState.gameOver = true;
                showGameMessage("æ¸¸æˆç»“æŸ! ğŸ˜¢", true);
            }
        }

        // æ£€æŸ¥æ˜¯å¦æœ‰å¯ç§»åŠ¨çš„æ–¹å—
        function hasMoves() {
            // æ£€æŸ¥æ˜¯å¦æœ‰ç©ºæ ¼
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    if (gameState.grid[i][j] === 0) {
                        return true;
                    }
                }
            }
            
            // æ£€æŸ¥æ˜¯å¦æœ‰å¯åˆå¹¶çš„ç›¸é‚»æ–¹å—
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    const value = gameState.grid[i][j];
                    
                    // æ£€æŸ¥å³ä¾§
                    if (j < 3 && gameState.grid[i][j+1] === value) {
                        return true;
                    }
                    
                    // æ£€æŸ¥ä¸‹æ–¹
                    if (i < 3 && gameState.grid[i+1][j] === value) {
                        return true;
                    }
                }
            }
            
            return false;
        }

        // æ˜¾ç¤ºæ¸¸æˆæ¶ˆæ¯
        function showGameMessage(message, isGameOver) {
            elements.gameMessage.style.display = 'flex';
            elements.gameMessage.querySelector('p').textContent = message;
            
            if (isGameOver) {
                elements.gameMessage.querySelector('button').textContent = 'å†è¯•ä¸€æ¬¡';
            } else {
                elements.gameMessage.querySelector('button').textContent = 'ç»§ç»­æ¸¸æˆ';
            }
        }

        // æ›´æ–°UI
        function updateUI() {
            // æ›´æ–°åˆ†æ•°
            elements.score.textContent = gameState.score;
            
            // æ›´æ–°æœ€ä½³åˆ†æ•°
            if (gameState.score > gameState.bestScore) {
                gameState.bestScore = gameState.score;
                elements.bestScore.textContent = gameState.bestScore;
                localStorage.setItem('2048_best_score', gameState.bestScore);
            }
            
            // æ›´æ–°æ‰€æœ‰æ–¹å—ä½ç½®
            document.querySelectorAll('.tile').forEach(tile => {
                updateTilePosition(tile);
            });
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬
        function setupEventListeners() {
            // é”®ç›˜æ§åˆ¶
            document.addEventListener('keydown', (e) => {
                if (gameState.gameOver) return;
                
                switch (e.key) {
                    case 'ArrowUp': move('up'); break;
                    case 'ArrowDown': move('down'); break;
                    case 'ArrowLeft': move('left'); break;
                    case 'ArrowRight': move('right'); break;
                }
            });
            
            // è§¦æ‘¸æ§åˆ¶
            let touchStartX = 0;
            let touchStartY = 0;
            
            document.querySelector('.grid-container').addEventListener('touchstart', (e) => {
                if (gameState.gameOver) return;
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
                e.preventDefault();
            }, { passive: false });
            
            document.querySelector('.grid-container').addEventListener('touchend', (e) => {
                if (gameState.gameOver || !touchStartX || !touchStartY) return;
                
                const touchEndX = e.changedTouches[0].clientX;
                const touchEndY = e.changedTouches[0].clientY;
                
                const dx = touchEndX - touchStartX;
                const dy = touchEndY - touchStartY;
                const absDx = Math.abs(dx);
                const absDy = Math.abs(dy);
                
                // ç¡®å®šæ»‘åŠ¨æ–¹å‘ï¼ˆéœ€è¦æ˜æ˜¾æ»‘åŠ¨æ‰è§¦å‘ï¼‰
                if (Math.max(absDx, absDy) > 30) {
                    if (absDx > absDy) {
                        // æ°´å¹³æ»‘åŠ¨
                        if (dx > 0) move('right');
                        else move('left');
                    } else {
                        // å‚ç›´æ»‘åŠ¨
                        if (dy > 0) move('down');
                        else move('up');
                    }
                }
                
                touchStartX = 0;
                touchStartY = 0;
            });
            
            // é‡æ–°å¼€å§‹æŒ‰é’®
            elements.restartButton.addEventListener('click', () => {
                resetGame();
                addRandomTile();
                addRandomTile();
                updateUI();
            });
            
            // æ¸¸æˆæ¶ˆæ¯æŒ‰é’®
            elements.gameMessage.querySelector('button').addEventListener('click', () => {
                if (gameState.gameOver) {
                    resetGame();
                    addRandomTile();
                    addRandomTile();
                } else {
                    elements.gameMessage.style.display = 'none';
                }
                updateUI();
            });
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        window.addEventListener('load', () => {
            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æœ€ä½³åˆ†æ•°
            gameState.bestScore = parseInt(localStorage.getItem('2048_best_score')) || 0;
            elements.bestScore.textContent = gameState.bestScore;
            
            // ç¡®ä¿ç½‘æ ¼æ¸²æŸ“å®Œæˆ
            createGrid();
            
            // åˆå§‹åŒ–æ¸¸æˆ
            setTimeout(initGame, 50);
        });

        // çª—å£å¤§å°å˜åŒ–æ—¶æ›´æ–°æ–¹å—ä½ç½®
        window.addEventListener('resize', () => {
            document.querySelectorAll('.tile').forEach(tile => {
                updateTilePosition(tile);
            });
        });
    </script>
</body>
</html>
